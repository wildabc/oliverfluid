Modified from http://nerget.com/fluidSim/
